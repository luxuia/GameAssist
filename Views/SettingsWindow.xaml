<Window x:Class="GameAssist.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Settings" Height="600" Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanMinimize">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- API Provider Configuration -->
                <GroupBox Header="API Provider" Padding="10" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="Provider:" Margin="0,0,0,5"/>
                        <ComboBox x:Name="ProviderBox" Width="200" HorizontalAlignment="Left" Margin="0,0,0,10" SelectionChanged="ProviderBox_SelectionChanged">
                            <ComboBoxItem Content="OpenAI" Tag="OpenAI"/>
                            <ComboBoxItem Content="Zhipu AI (GLM-4.6v)" Tag="ZhipuAI"/>
                            <ComboBoxItem Content="Doubao (豆包)" Tag="Doubao"/>
                        </ComboBox>

                        <TextBlock x:Name="ApiKeyLabel" Text="OpenAI API Key:" Margin="0,0,0,5"/>
                        <PasswordBox x:Name="ApiKeyBox" Width="400" HorizontalAlignment="Left" Margin="0,0,0,10"/>

                        <TextBlock x:Name="EndpointLabel" Text="Endpoint:" Margin="0,0,0,5"/>
                        <TextBox x:Name="EndpointBox" Width="400" HorizontalAlignment="Left" Margin="0,0,0,10"/>
                    </StackPanel>
                </GroupBox>

                <!-- Model Configuration -->
                <GroupBox Header="Model Configuration" Padding="10" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="Model:" Margin="0,0,0,5"/>
                        <ComboBox x:Name="ModelBox" Width="300" HorizontalAlignment="Left" Margin="0,0,0,10" SelectionChanged="ModelBox_SelectionChanged">
                            <ComboBoxItem Content="gpt-4o" Tag="OpenAI" IsSelected="True"/>
                            <ComboBoxItem Content="gpt-4o-mini" Tag="OpenAI"/>
                            <ComboBoxItem Content="gpt-4-turbo" Tag="OpenAI"/>
                            <ComboBoxItem Content="gpt-4-vision-preview" Tag="OpenAI"/>
                            <ComboBoxItem Content="glm-4.6v" Tag="ZhipuAI"/>
                            <ComboBoxItem Content="glm-4v-flash" Tag="ZhipuAI"/>
                            <ComboBoxItem Content="doubao-seed-2-0-code-preview-260215" Tag="Doubao"/>
                            <ComboBoxItem Content="doubao-pro-32k-240615" Tag="Doubao"/>
                            <ComboBoxItem Content="doubao-pro-4k-240615" Tag="Doubao"/>
                        </ComboBox>

                        <TextBlock Text="Max Tokens:" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Slider x:Name="MaxTokensSlider" Width="200" Minimum="100" Maximum="2000" Value="500" TickFrequency="100" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="MaxTokensLabel" Text="500" Width="50" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Text="Temperature:" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Slider x:Name="TemperatureSlider" Width="200" Minimum="0" Maximum="1" Value="0.7" TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="TemperatureLabel" Text="0.7" Width="50" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>

                        <Button Content="Test API" Width="100" HorizontalAlignment="Left" Click="TestApi_Click"/>
                    </StackPanel>
                </GroupBox>

                <!-- Analysis Settings -->
                <GroupBox Header="Analysis Settings" Padding="10" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="Capture Interval (seconds):" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Slider x:Name="IntervalSlider" Width="200" Minimum="10" Maximum="300" Value="60" TickFrequency="10" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="IntervalLabel" Text="60s" Width="50" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>

                        <CheckBox x:Name="Dota2OnlyCheckBox" Content="Only analyze when Dota 2 is active" IsChecked="True" Margin="0,0,0,10"/>
                        <CheckBox x:Name="ShowPreviewCheckBox" Content="Show screenshot preview in main window" IsChecked="True" Margin="0,0,0,10"/>
                        <CheckBox x:Name="AutoStartCheckBox" Content="Auto-start when application launches" IsChecked="False"/>
                    </StackPanel>
                </GroupBox>

                <!-- Overlay Settings -->
                <GroupBox Header="Overlay Settings" Padding="10" Margin="0,0,0,15">
                    <StackPanel>
                        <CheckBox x:Name="OverlayEnabledCheckBox" Content="Enable overlay" IsChecked="True" Margin="0,0,0,10"/>

                        <TextBlock Text="Overlay Width:" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Slider x:Name="OverlayWidthSlider" Width="200" Minimum="300" Maximum="1200" Value="600" TickFrequency="50" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="OverlayWidthLabel" Text="600" Width="50" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Text="Font Size:" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Slider x:Name="FontSizeSlider" Width="200" Minimum="12" Maximum="24" Value="16" TickFrequency="1" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="FontSizeLabel" Text="16" Width="50" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Text="Auto-hide after (seconds):" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal">
                            <Slider x:Name="AutoHideSlider" Width="200" Minimum="10" Maximum="60" Value="30" TickFrequency="5" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="AutoHideLabel" Text="30s" Width="50" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Image Compression Settings -->
                <GroupBox Header="Image Compression" Padding="10" Margin="0,0,0,15">
                    <StackPanel>
                        <CheckBox x:Name="EnableCompressionCheckBox" Content="Enable image compression" IsChecked="True" Margin="0,0,0,10"/>

                        <TextBlock Text="Compression Quality:" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Slider x:Name="CompressionQualitySlider" Width="200" Minimum="10" Maximum="100" Value="80" TickFrequency="5" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="CompressionQualityLabel" Text="80" Width="50" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Text="Max Image Size (KB):" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal">
                            <Slider x:Name="MaxImageSizeSlider" Width="200" Minimum="500" Maximum="5000" Value="2000" TickFrequency="100" IsSnapToTickEnabled="True"/>
                            <TextBlock x:Name="MaxImageSizeLabel" Text="2000 KB" Width="70" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Prompt Configuration -->
                <GroupBox Header="Prompt Configuration" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Prompt Type:" Margin="0,0,0,5"/>
                        <ComboBox x:Name="PromptTypeBox" Width="200" HorizontalAlignment="Left" Margin="0,0,0,10" SelectionChanged="PromptTypeBox_SelectionChanged">
                            <ComboBoxItem Content="Default"/>
                            <ComboBoxItem Content="Hero Build (英雄搭配)"/>
                            <ComboBoxItem Content="Laning Phase"/>
                            <ComboBoxItem Content="Team Fight"/>
                            <ComboBoxItem Content="Itemization"/>
                            <ComboBoxItem Content="Late Game"/>
                            <ComboBoxItem Content="Custom"/>
                        </ComboBox>

                        <TextBlock Text="Custom Prompt:" Margin="0,0,0,5"/>
                        <TextBox x:Name="CustomPromptBox" Width="550" Height="80" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Save" Width="80" Margin="0,0,10,0" Click="Save_Click"/>
            <Button Content="Cancel" Width="80" Click="Cancel_Click"/>
        </StackPanel>
    </Grid>
</Window>
